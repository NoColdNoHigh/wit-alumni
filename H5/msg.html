<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no, target-densitydpi=device-dpi">
    <meta name="keywords" content="校友录，校友会,手机校友录，慧脑校友录">
    <meta name="description" content="慧脑校友录,手机校友录，校友会">
    <link rel="stylesheet" type="text/css" href="../css/alumni.css">
    <link rel="stylesheet" type="text/css" href="../css/witcs.css">
    <script src="../js/witjs.js"></script>
    <title>校友录</title>
</head>
<style>
    input {
        display: block;
        outline: none;
    }
    input:focus{
        background: #FFF;
        text-align: center;
    }
</style>
<body class="ofa" onload="loadend()" onresize="autocss()">
<div id="s_select" class="none index999 fix bottom0 W11 CH callnone "></div>
<div id="re_page" class="none index99 fix bottom0 W11 CH callnone"></div>
<div id="myDetails" class="W11  bgc9  ffWRYH">

    <div class="index9 fix top0 H W11 AC ffHT  bgc9">个人信息
        <img src='../images/icon/back_b.png' class="FL P1M B4M H4M" onclick="location.href='index.html'"/>
        <div class="H4M FR F3 colorff PR1M">保存</div>
    </div>
    <div class=" W11 MTH PL1M PR1M bgc10  bordBDe6">
        <div class="H6M flexbox">
            <div class="W31 FL H AL">头像</div>
            <div class="W32 FR  flexbox">
                <div class="W11 AR H6M">
                    <img src="../images/pic1.png" class="H6M B6M P05M rad1 AR" alt="" id="myImg">
                </div>
                <div class=" AR color8">
                    <div class=" AR">&#62</div>
                </div>
            </div>
        </div>
    </div>

    <div class="H1M W11 bgcaf5 bordBDe6"></div>
    <div class=" W11  PL1M PR1M bgc10  bordBDe6">
        <div class="bordBDe6  H4M flexbox">
            <div class="W31 FL H AL">名字</div>
            <input type="text" class="W32 FR AR color8 H ellips ffWRYH " id="myname" placeholder="" value=""/>
            <!--<div id="myname" class="W32 FR AR color8 ellips" data-t="my_msg">-->
            <!--</div>-->
            <div class="ML AR color8">
                <div class=" AR">&#62</div>
            </div>
        </div>
        <div class="bordBDe6  H4M flexbox" >
            <div class="W31 FL H AL">性别</div>
            <div id="mysex" class="W32 FR AR color8 H ellips" title="-1" data-t="radio" data-s="男,女"></div>
            <!--<div id="mysex" class="W32 FR AR color8 ellips">-->
            <!--</div>-->
            <div class="ML AR color8">
                <div class=" AR">&#62</div>
            </div>
        </div>
        <div class="  H4M flexbox" >
            <div class="W31 FL H AL">生日</div>
            <div  data-in="title" id="mybirthday" class="W32 FR AR color8 H ellips" onclick="wit_date.init(this,0, '012','年月日');">
            <!--<div id="mybirthday" class="W32 FR AR color8 ellips">-->
            </div>
            <div class="ML AR color8">
                <div class=" AR">&#62</div>
            </div>
        </div>
    </div>
    <div class="H1M W11 bgcaf5 bordBDe6"></div>
    <div class=" W11  PL1M PR1M bgc10  bordBDe6">
        <div class="bordBDe6  H4M flexbox">
            <div class="W31 FL H AL">邮箱</div>
            <input type="text" class="W32 FR AR color8 H ellips ffWRYH " id="mymail" placeholder="" value=""/>
            <!--<div id="mymail" class="W32 FR AR color8 ellips" data-t="my_msg">-->
            <!--</div>-->
            <div class="ML AR color8">
                <div class=" AR">&#62</div>
            </div>
        </div>
        <div class="bordBDe6  H4M flexbox" >
            <div class="W31 FL H AL">QQ</div>
            <input type="text" class="W32 FR AR color8 H ellips ffWRYH " id="myqq" placeholder="" value=""/>
            <!--<div id="myqq" class="W32 FR AR color8 ellips" data-t="my_msg">-->
            <!--</div>-->
            <div class="ML AR color8">
                <div class=" AR">&#62</div>
            </div>
        </div>
        <div class="  H4M flexbox">
            <div class="W31 FL H AL">微信</div>
            <input type="text" class="W32 FR AR color8 H ellips ffWRYH " id="mywx" placeholder="" value=""/>
            <!--<div id="mywx" class="W32 FR AR color8 ellips" data-t="my_msg">-->
            <!--</div>-->
            <div class="ML AR color8">
                <div class=" AR">&#62</div>
            </div>
        </div>
    </div>
    <div class="H1M W11 bordBDe6"></div>
    <div class=" W11  PL1M PR1M bgc10  bordBDe6 ">
        <div class="bordBDe6  H4M flexbox" >
            <div class="W31 FL H AL">邮编</div>
            <input type="text" class="W32 FR AR color8 H ellips ffWRYH " id="myzcode" placeholder="" value=""/>
            <!--<div id="myzcode" class="W32 FR AR color8 ellips" data-t="my_msg">-->
            <!--</div>-->
            <div class="ML AR color8">
                <div class=" AR">&#62</div>
            </div>
        </div>
        <div class="  HN4M flexbox"  onclick="updateAddr(this)" >
            <div class="W41 FL H AL">地址</div>
            <div id="myaddr" class="W43 FR P05M AR color8 " data-t="my_msg">
            </div>
            <div class="ML AR color8">
                <div class=" AR">&#62</div>
            </div>
        </div>

    </div>
    <div class="H1M W11 bordBDe6"></div>
    <div class=" W11  PL1M PR1M bgc10  bordBDe6">
        <div class="bordBDe6  H4M flexbox" >
            <div class="W31 FL H AL">学历</div>
            <div id="myeducation"  class="W32 FR AR color8 H ellips" data-t="check" data-s="无,小学,初中,高中,中专,大专,本科,学士,硕士,博士">
            <!--<div id="myeducation" class="W32 FR AR color8 ellips" data-t="my_msg">-->
            </div>
            <div class="ML AR color8">
                <div class=" AR">&#62</div>
            </div>
        </div>
        <div class="  H4M flexbox" >
            <div class="W31 FL H AL">毕业院校</div>
            <input type="text" class="W32 FR AR color8 H ellips ffWRYH " id="mygraduation" placeholder="" value=""/>
            <!--<div id="mygraduation" class="W32 FR AR color8 ellips" data-t="my_msg">-->
            <!--</div>-->
            <div class="ML AR color8">
                <div class=" AR">&#62</div>
            </div>
        </div>
    </div>
    <div class="H1M W11 bordBDe6"></div>
    <div class=" W11  PL1M PR1M bgc10  bordBDe6">
        <div class="bordBDe6  H4M flexbox" >
            <div class="W31 FL H AL">行业</div>
            <div id="myindustry" class="W32 FR AR color8 H ellips" data-t="check"
                 data-s="其它, 公务, 教育, 医疗, 科研设计, 农业, 食品, 纺织服饰, 轻工, 能源矿材, 化工, 五金机电, 仪器仪表, 家电, 设备制造, 建筑房产, 交通工业, 物流服务, 信息产业, 商贸, 金融, 商务服务, 居民服务, 环境管理, 文化娱乐, 餐住旅游">
            <!--<div id="myindustry" class="W32 FR AR color8 ellips" data-t="my_msg">-->
            </div>
            <div class="ML AR color8">
                <div class=" AR">&#62</div>
            </div>
        </div>
        <div class="bordBDe6  H4M flexbox">
            <div class="W31 FL H AL">单位</div>
            <input type="text" class="W32 FR AR color8 H ellips ffWRYH " id="mycomp" placeholder="" value=""/>
            <!--<div id="mycomp" class="W32 FR AR color8 ellips" data-t="my_msg">-->
            <!--</div>-->
            <div class="ML AR color8">
                <div class=" AR">&#62</div>
            </div>
        </div>

        <div class="bordBDe6  H4M flexbox" >
            <div class="W31 FL H AL">部门</div>
            <div id="mydept" class="W32 FR AR color8 H ellips" data-t="check"
                     data-s="生产部,销售部,财务部,技术部,品质部,采购部,行政部,人事部,物流部,企划部,外贸部,市场部,设备部,总经办">
            <!--<div id="mydept" class="W32 FR AR color8 ellips" data-t="my_msg">-->
            </div>
            <div class="ML AR color8">
                <div class=" AR">&#62</div>
            </div>
        </div>
        <div class="bordBDe6  H4M flexbox" >
            <div class="W31 FL H AL">职务</div>
            <div id="myjob"  class="W32 FR AR color8 H ellips" data-t="check"
                   data-s="董事长,总经理,经理,主任,部长,局长,处长,科长,队长,组长,助理,科员,办事员,院长,书记,主席,总监,监理,总编,主编,主治">
            <!--<div id="myjob" class="W32 FR AR color8 ellips" data-t="my_msg">-->
            </div>
            <div class="ML AR color8">
                <div class=" AR">&#62</div>
            </div>
        </div>
        <div class="bordBDe6  H4M flexbox" >
            <div class="W31 FL H AL">职称</div>
            <div id="mycareer"  class="W32 FR AR color8 H ellips" data-t="check"
                         data-s="教授,副教授,高级讲师,讲师,特级教师,高级教师,一级教师,研究员,副研究员,教授级高工,高级工程师,工程师,主任医师,副主任医师,主治医师,主管护师,高级经济师,经济师,高级会计师,会计师">
            <!--<div id="mycareer" class="W32 FR AR color8 ellips" data-t="my_msg">-->
            </div>
            <div class="ML AR color8">
                <div class=" AR">&#62</div>
            </div>
        </div>
        <div class="bordBDe6  flexbox">
            <textarea class=" FL  W11 F3 ALP  bordBD1 ffWRYH " rows="4"  style="resize:none"  id="myhonor" placeholder="请填写荣誉" ></textarea>
            <!--<div id="myhonor" class="W32 FR AR color8 ellips" data-t="my_msg">-->
            <!--</div>-->
            <!--<div class="ML AR color8">-->
                <!--<div class=" AR">&#62</div>-->
            <!--</div>-->
        </div>
    </div>
    <div class=" H1M W11 bordBDe6"></div>
    <div class=" W11  bgc119  bordBDe6">
        <details>
            <summary class="FL AL W11 P1M bordBD1 ">已加班级</summary>
            <div id="myAllClass"></div>
        </details>
        <div class="clear"></div>
    </div>
    <div class=" H1M W11 bordBDe6"></div>
    <div class="W11 H AC bgcff" id="saveMsg">保存</div>

</div>
</body>
</html>
<script src="../js/wit_ajax.js"></script>
<script src="../js/witconfig.js"></script>
<script src="../js/witjsdate.js"></script>
<script src="../js/witjsaddr.js"></script>
<script src="../js/wit_app.js"></script>
<script type="text/javascript">
    "use strict";
    var _userguid, _token, _editor, _phone;
    const _url = "http://121.43.233.185/alumnicloudweb";
    var myObject, myPrivacy, myPersocial;

    function loadend() {
        autocss();
        loadimg();
        _wit.postmessage({functionname: "getuser", callback: "callback"});
    }

    function callback(msg) {
        console.log(msg);
        var info = msg.perinfo;
        //获取班级信息
        var myclass = info.perexpeducationjson;
        myObject = info.perobjectjson;
        myPrivacy = info.perprivacyobjectjson;
        myPersocial = info.persocialinforobjectjson;
        console.log(myclass);
        C_mydetails(myclass);
        _wit.postmessage({functionname: 'getuserinfo', callback: 'init'});
    }

    function init(msg) {
        console.log(msg);
        if (msg.result >= 0) {
            var info = msg.message;
            _userguid = info.user_guid;
            _token = info.token;
            _editor = info.per_full_name;
            _phone = info.user_phone;
            _wit.event.input_UI("s_select", function (i, v, d) {
                console.log(i, v, d);
            });
            var myImg = document.getElementById("myImg");
            console.log(myImg);
            if (info.per_portrait){
                myImg.src = info.localpath + info.per_portrait;
                console.log(myImg.src);
            }else {
                myImg.src="../images/port03.jpg";
            }
            getClassMsg();
            _wit.event.div_UI("s_select");
            _wit.event.input_limit();

        } else {
            _wd.info("用户非法，请重新登录！", "bgc24");
            // _fun.toAlert("用户非法，请重新登录！");
        }
    }

    function C_mydetails(c) {
        document.getElementById("myAllClass").innerHTML = "";
        console.log(c);
        c.forEach(function (v) {
            var div = document.createElement("p");
            div.className = " AL W11 H4M  bordBD1 FL";
            div.innerHTML = '<div class="FL LH25">' + v.unit_name + " " + v.dept + " " + _wd.getCut("-", 0, v.date_end || "") + "届" + " " + _wd.getCut("||", 1, v.class_name) + "班" + '</div>' +
                '<div class="B3M H3M FR" onclick="del_school(' + v.id + ')" ><img class="B3M H3M P05M" src="../images/icon/delete.png" alt=""></div>  ';
            document.getElementById("myAllClass").appendChild(div);
        });
    }

    function getClassMsg() {
        const c = myPrivacy;
        const o = myObject;
        const b = myPersocial;
        console.log(c, o, b);
        var myName = document.getElementById("myname");
        myName.value = o.per_full_name || "";
        var mySex = document.getElementById("mysex");
        var sex = "";
        switch (o.per_sex) {
            case 0:
                sex = "";
                break;
            case 1:
                sex = " 男";
                break;
            case 2:
                sex = "女";
                break;
            case "":
                sex = "";
                break;
        }
        mySex.innerText = sex;
        var mybirth = document.getElementById("mybirthday");
        mybirth.innerText = b.per_birth_date || "";

        var myMail = document.getElementById("mymail");
        myMail.value = o.per_email || "";

        var myQQ = document.getElementById("myqq");
        myQQ.value = o.per_qq || "";

        var myWX = document.getElementById("mywx");
        myWX.value = o.per_webchat || "";

        var myAddr = document.getElementById("myaddr");
        myAddr.innerText = _wd.getCut("@@", 0, o.per_address || "") + _wd.getCut("@@", 1, o.per_address || "") || "";

        var myZcode = document.getElementById("myzcode");
        myZcode.innerText = _wd.getCut("||", 2, o.per_address || "") || "";

        var myEdu = document.getElementById("myeducation");
        myEdu.innerText = c.per_education || "";

        var myGraduation = document.getElementById("mygraduation");
        myGraduation.innerText = "";

        var myIndustry = document.getElementById("myindustry");
        myIndustry.innerText = parseInt(parseInt(o.per_industry) / 100) || "";

        var myComp = document.getElementById("mycomp");
        myComp.value = o.per_unit_name || "";

        var myCareer = document.getElementById("mycareer");
        myCareer.innerText = c.per_job_title || "";

        var myDept = document.getElementById("mydept");
        myDept.innerText = o.per_dept || "";

        var myJob = document.getElementById("myjob");
        myJob.innerText = o.per_position || "";

        var myHonor = document.getElementById("myhonor");
        myHonor.innerText = "";
    }

    function updateAddr(p) {
        var cont = p.children[1].innerText;
        var inHtml = '<div id="per_address0"   data-in="title" class="FL W11 F3 H4M LH3   bordBD1  bgcddc  color876 bord_select AC" onclick="creat_addr(4,0)">请选择所在区域</div>' +
                    '<div class="FL F2 W11 P1M bgc9">详细地址：</div>' +
                    '<textarea class=" FL  W11 F3 ALP  bordBD1 ffWRYH " rows="4"  style="resize:none"  id="re_content"  >' + cont + '</textarea>';

        document.getElementById("re_page").innerHTML = "";
        var div = document.createElement("div");
        div.className = " W11 index99 fix bgc9 CH";
        div.innerHTML = '<div class="top0 H W11 AC ffHT bgc9 ">设置地址'  +
            '    <div  class="FL B4M H4M F2" onclick="_wd.hide(re_page)"> 取消</div>' +
            '    <div  class="FR B4M H4M F2  colorff" id="n_release"> 完成</div>' +
            '</div><div class="bgc10 W11 F2 AL F3" id="up_list">' + inHtml +
            '</div>';
        document.getElementById("re_page").appendChild(div);
        _wd.show("re_page");
        _wit.event.div_UI("s_select");
        var update = document.getElementById("n_release");
        update.onclick = function () {
            var d = document.querySelector("#up_list>input");
            if (d) {
                console.log(d.value);
                console.log(d.id);
            } else {
                var t = document.querySelector("#up_list>div");
                console.log(t);
                console.log(t.id);
            }

        };
    }


    function del_school(id) {
        console.log(id);
        _wit.postmessage({
            functionname: "deleteexp",
            witparams: {
                type: 0,
                id: id
            },
            callbackparam: JSON.stringify({
                type: 0,
                id: id
            }),
            callback: "delExp"
        });
    }

    function delExp(msg, param) {
        console.log("正在删除");
        console.log(msg);
        var j = msg,
            p = JSON.parse(param);
        if (j && j.result >= 0) {
            _wd.info("删除成功！", "bgc5e");
            _wit.postmessage({functionname: "getuser", callback: "callback"});
            // document.location.reload(); //当前页面
            //其他端免回调
        }
        // else {//pc端
        //     var o = p.json;
        //     console.log(o);
        //     console.log(p.type);
        //     p.type === 0 && externalfun.deleteexp(function (msg) {
        //         console.log(msg);
        //         _fun.toLoading(-1);
        //         var j = JSON.parse(msg);
        //         if (j.result >= 0) {
        //             _wd.info("删除成功！", "bgc5e");
        //             // document.location.reload(); //当前页面
        //             _wit.postmessage({functionname: "getuser", callback: "callback"});
        //         }
        //     }, p.id, 0);
        // }
    }
</script>
